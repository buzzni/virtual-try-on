<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VTO Auth Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; }
        .section { background: white; padding: 20px; margin-bottom: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { margin-bottom: 20px; color: #333; }
        h2 { margin-bottom: 15px; color: #666; font-size: 18px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #555; font-weight: bold; }
        input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px; white-space: pre-wrap; font-family: monospace; font-size: 12px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .token-display { margin-top: 10px; padding: 10px; background: #e7f3ff; border-radius: 4px; }
        .token-display strong { display: block; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª VTO Auth API Test</h1>

        <!-- Signup Test -->
        <div class="section">
            <h2>ğŸ“ Sign Up</h2>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="signupEmail" value="test@example.com">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="signupPassword" value="password123">
            </div>
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="signupName" value="John">
            </div>
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" id="signupLastName" value="Doe">
            </div>
            <div class="form-group">
                <label>Language</label>
                <select id="signupLanguage" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="ko">í•œêµ­ì–´</option>
                    <option value="en">English</option>
                    <option value="ja">æ—¥æœ¬èª</option>
                </select>
            </div>
            <div class="form-group">
                <label>Phone Number</label>
                <input type="text" id="signupPhoneNumber" placeholder="010-1234-5678">
            </div>
            <div class="form-group">
                <label>Organization Name</label>
                <input type="text" id="signupOrganizationName" placeholder="ì˜ˆ: Buzzni">
            </div>
            <div class="form-group">
                <label>Terms Agreement</label>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="signupTermsAgreed">
                        <span>ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ ë™ì˜ (í•„ìˆ˜)</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="signupPrivacyAgreed">
                        <span>ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ë™ì˜ (í•„ìˆ˜)</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="signupMarketingAgreed">
                        <span>ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  ë™ì˜ (ì„ íƒ)</span>
                    </label>
                </div>
            </div>
            <button onclick="testSignup()">Sign Up</button>
            <div id="signupResult" class="result" style="display: none;"></div>
        </div>

        <!-- Login Test -->
        <div class="section">
            <h2>ğŸ“§ Email Login Test</h2>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="loginEmail" value="test@example.com">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="loginPassword" value="password123">
            </div>
            <button onclick="testLogin()">Login</button>
            <div id="loginResult" class="result" style="display: none;"></div>
        </div>

        <!-- Google OAuth Test -->
        <div class="section">
            <h2>ğŸ”µ Google OAuth Test</h2>
            <div class="form-group">
                <label>Google Access Token</label>
                <input type="text" id="googleToken" placeholder="Google access token">
            </div>
            <button onclick="testGoogleOAuth()">Test Google OAuth</button>
            <div id="googleResult" class="result" style="display: none;"></div>
        </div>

        <!-- Kakao OAuth Test -->
        <div class="section">
            <h2>ğŸŸ¡ Kakao OAuth Test</h2>
            <div class="form-group">
                <label>Kakao Access Token</label>
                <input type="text" id="kakaoToken" placeholder="Kakao access token">
            </div>
            <button onclick="testKakaoOAuth()">Test Kakao OAuth</button>
            <div id="kakaoResult" class="result" style="display: none;"></div>
        </div>

        <!-- Saved Token -->
        <div class="section" id="tokenSection" style="display: none;">
            <h2>ğŸ”‘ Saved Token</h2>
            <div class="token-display">
                <strong>Access Token:</strong>
                <div id="savedToken" style="word-break: break-all;"></div>
            </div>
            <button onclick="clearToken()">Clear Token</button>
        </div>

        <hr style="margin: 30px 0; border: none; border-top: 2px solid #ddd;">
        <h1>ğŸ‘¤ VTO User API Test</h1>

        <!-- Get Me -->
        <div class="section">
            <h2>ğŸ‘ï¸ Get My Profile</h2>
            <p style="margin-bottom: 15px; color: #666;">ë¡œê·¸ì¸ í›„ í† í°ì´ ìˆì–´ì•¼ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
            <button onclick="testGetMe()">Get My Info</button>
            <div id="getMeResult" class="result" style="display: none;"></div>
        </div>

        <!-- Update Me -->
        <div class="section">
            <h2>âœï¸ Update My Profile</h2>
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="updateName" value="Jane">
            </div>
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" id="updateLastName" value="Smith">
            </div>
            <div class="form-group">
                <label>Profile Picture URL</label>
                <input type="text" id="updateProfilePic" placeholder="https://example.com/pic.jpg">
            </div>
            <div class="form-group">
                <label>Language</label>
                <select id="updateLanguage" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="ko">í•œêµ­ì–´</option>
                    <option value="en">English</option>
                    <option value="ja">æ—¥æœ¬èª</option>
                </select>
            </div>
            <div class="form-group">
                <label>Phone Number</label>
                <input type="text" id="updatePhoneNumber" placeholder="010-1234-5678">
            </div>
            <div class="form-group">
                <label>Organization Name</label>
                <input type="text" id="updateOrganizationName" placeholder="ì˜ˆ: Buzzni">
            </div>
            <div class="form-group">
                <label>Agreements</label>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="updateTermsAgreed">
                        <span>ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ ë™ì˜</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="updatePrivacyAgreed">
                        <span>ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ë™ì˜</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="updateMarketingAgreed">
                        <span>ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  ë™ì˜</span>
                    </label>
                </div>
            </div>
            <button onclick="testUpdateMe()">Update Profile</button>
            <div id="updateMeResult" class="result" style="display: none;"></div>
        </div>

        <!-- Delete Me -->
        <div class="section">
            <h2>ğŸ—‘ï¸ Delete My Account</h2>
            <p style="margin-bottom: 15px; color: #d00;">âš ï¸ ê³„ì • ì‚­ì œ ì‹œ ëª¨ë“  ê´€ë ¨ ë°ì´í„°(í¬ì¸íŠ¸, êµ¬ë…, í”„ë¡œì íŠ¸ ë“±)ê°€ ì˜êµ¬ ì‚­ì œë©ë‹ˆë‹¤.</p>
            <button onclick="testDeleteMe()" style="background: #dc3545;">Delete My Account</button>
            <div id="deleteMeResult" class="result" style="display: none;"></div>
        </div>

        <hr style="margin: 30px 0; border: none; border-top: 2px solid #ddd;">
        <h1>ğŸ“Š VTO Project API Test</h1>

        <!-- Create Project -->
        <div class="section">
            <h2>â• Create Project</h2>
            <p style="margin-bottom: 15px; color: #666;">ë¡œê·¸ì¸ í›„ í† í°ì´ ìˆì–´ì•¼ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
            <div class="form-group">
                <label>Collection ID</label>
                <input type="text" id="projectCollectionId" placeholder="collection-uuid">
            </div>
            <div class="form-group">
                <label>Project Name</label>
                <input type="text" id="projectName" value="My First Project">
            </div>
            <button onclick="testCreateProject()">Create Project</button>
            <div id="createProjectResult" class="result" style="display: none;"></div>
        </div>

        <!-- Get Project -->
        <div class="section">
            <h2>ğŸ” Get Project</h2>
            <div class="form-group">
                <label>Project ID</label>
                <input type="text" id="getProjectId" placeholder="project-uuid">
            </div>
            <button onclick="testGetProject()">Get Project</button>
            <div id="getProjectResult" class="result" style="display: none;"></div>
        </div>

        <!-- Get Projects -->
        <div class="section">
            <h2>ğŸ“‹ Get Projects</h2>
            <p style="margin-bottom: 15px; color: #666;">ë‚´ í”„ë¡œì íŠ¸ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.</p>
            <button onclick="testGetProjects()">Get All Projects</button>
            <div id="getProjectsResult" class="result" style="display: none;"></div>
        </div>

        <!-- Get Projects by Collection -->
        <div class="section">
            <h2>ğŸ—‚ï¸ Get Projects by Collection</h2>
            <div class="form-group">
                <label>Collection ID</label>
                <input type="text" id="filterCollectionId" placeholder="collection-uuid">
            </div>
            <button onclick="testGetProjectsByCollection()">Get Projects</button>
            <div id="getProjectsByCollectionResult" class="result" style="display: none;"></div>
        </div>

        <hr style="margin: 30px 0; border: none; border-top: 2px solid #ddd;">
        <h1>ğŸ“ VTO Collection API Test</h1>

        <!-- Create Collection -->
        <div class="section">
            <h2>â• Create Collection</h2>
            <p style="margin-bottom: 15px; color: #666;">ë¡œê·¸ì¸ í›„ í† í°ì´ ìˆì–´ì•¼ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
            <div class="form-group">
                <label>Collection Name</label>
                <input type="text" id="collectionName" value="My First Collection">
            </div>
            <button onclick="testCreateCollection()">Create Collection</button>
            <div id="createCollectionResult" class="result" style="display: none;"></div>
        </div>

        <!-- Get Collections -->
        <div class="section">
            <h2>ğŸ“‹ Get Collections</h2>
            <p style="margin-bottom: 15px; color: #666;">ë‚´ ì»¬ë ‰ì…˜ ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.</p>
            <button onclick="testGetCollections()">Get My Collections</button>
            <div id="getCollectionsResult" class="result" style="display: none;"></div>
        </div>

        <!-- Update Collection -->
        <div class="section">
            <h2>âœï¸ Update Collection</h2>
            <div class="form-group">
                <label>Collection ID</label>
                <input type="text" id="updateCollectionId" placeholder="collection-uuid">
            </div>
            <div class="form-group">
                <label>New Name</label>
                <input type="text" id="updateCollectionName" value="Updated Collection">
            </div>
            <button onclick="testUpdateCollection()">Update Collection</button>
            <div id="updateCollectionResult" class="result" style="display: none;"></div>
        </div>

        <!-- API Settings -->
        <div class="section">
            <h2>âš™ï¸ API Settings</h2>
            <div class="form-group">
                <label>API Base URL</label>
                <input type="text" id="apiUrl" value="http://localhost:8000">
            </div>
        </div>
    </div>

    <script>
        const API_URL = () => document.getElementById('apiUrl').value;
        let savedAccessToken = null;

        function showResult(elementId, data, isSuccess) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = 'result ' + (isSuccess ? 'success' : 'error');
            element.textContent = JSON.stringify(data, null, 2);
        }

        function saveToken(token, userId) {
            savedAccessToken = token;
            document.getElementById('tokenSection').style.display = 'block';
            document.getElementById('savedToken').textContent = token;
            localStorage.setItem('vto_access_token', token);
            localStorage.setItem('vto_user_id', userId);
        }

        function clearToken() {
            savedAccessToken = null;
            document.getElementById('tokenSection').style.display = 'none';
            localStorage.removeItem('vto_access_token');
            localStorage.removeItem('vto_user_id');
        }

        async function testLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                const response = await fetch(`${API_URL()}/api/v1/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, password })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('loginResult', data, true);
                    saveToken(data.access_token, data.user_id);
                } else {
                    showResult('loginResult', data, false);
                }
            } catch (error) {
                showResult('loginResult', { error: error.message }, false);
            }
        }

        async function testGoogleOAuth() {
            const token = document.getElementById('googleToken').value;

            try {
                const response = await fetch(`${API_URL()}/api/v1/auth/oauth/google`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        provider: 'google',
                        access_token: token 
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('googleResult', data, true);
                    saveToken(data.access_token, data.user_id);
                } else {
                    showResult('googleResult', data, false);
                }
            } catch (error) {
                showResult('googleResult', { error: error.message }, false);
            }
        }

        async function testKakaoOAuth() {
            const token = document.getElementById('kakaoToken').value;

            try {
                const response = await fetch(`${API_URL()}/api/v1/auth/oauth/kakao`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        provider: 'kakao',
                        access_token: token 
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('kakaoResult', data, true);
                    saveToken(data.access_token, data.user_id);
                } else {
                    showResult('kakaoResult', data, false);
                }
            } catch (error) {
                showResult('kakaoResult', { error: error.message }, false);
            }
        }

        async function testSignup() {
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const name = document.getElementById('signupName').value;
            const lastName = document.getElementById('signupLastName').value;
            const language = document.getElementById('signupLanguage').value;
            const phoneNumber = document.getElementById('signupPhoneNumber').value;
            const organizationName = document.getElementById('signupOrganizationName').value;
            const termsAgreed = document.getElementById('signupTermsAgreed').checked;
            const privacyAgreed = document.getElementById('signupPrivacyAgreed').checked;
            const marketingAgreed = document.getElementById('signupMarketingAgreed').checked;

            if (!termsAgreed || !privacyAgreed) {
                showResult('signupResult', { error: 'í•„ìˆ˜ ì•½ê´€ ë° ê°œì¸ì •ë³´ ë™ì˜ë¥¼ ì²´í¬í•´ì£¼ì„¸ìš”.' }, false);
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/auth/signup`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        email, 
                        password,
                        name,
                        last_name: lastName,
                        language,
                        phone_number: phoneNumber || null,
                        organization_name: organizationName || null,
                        terms_agreed: termsAgreed,
                        privacy_agreed: privacyAgreed,
                        marketing_agreed: marketingAgreed
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('signupResult', data, true);
                    saveToken(data.access_token, data.user_id);
                } else {
                    showResult('signupResult', data, false);
                }
            } catch (error) {
                showResult('signupResult', { error: error.message }, false);
            }
        }

        async function testGetMe() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('getMeResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/users/me`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('getMeResult', data, true);
                } else {
                    showResult('getMeResult', data, false);
                }
            } catch (error) {
                showResult('getMeResult', { error: error.message }, false);
            }
        }

        async function testUpdateMe() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('updateMeResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            const name = document.getElementById('updateName').value;
            const lastName = document.getElementById('updateLastName').value;
            const profilePic = document.getElementById('updateProfilePic').value;
            const language = document.getElementById('updateLanguage').value;
            const phoneNumber = document.getElementById('updatePhoneNumber').value;
            const organizationName = document.getElementById('updateOrganizationName').value;
            const termsAgreed = document.getElementById('updateTermsAgreed').checked;
            const privacyAgreed = document.getElementById('updatePrivacyAgreed').checked;
            const marketingAgreed = document.getElementById('updateMarketingAgreed').checked;

            try {
                const response = await fetch(`${API_URL()}/api/v1/users/me`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        name,
                        last_name: lastName,
                        profile_picture: profilePic || null,
                        language,
                        phone_number: phoneNumber || null,
                        organization_name: organizationName || null,
                        terms_agreed: termsAgreed,
                        privacy_agreed: privacyAgreed,
                        marketing_agreed: marketingAgreed
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('updateMeResult', data, true);
                } else {
                    showResult('updateMeResult', data, false);
                }
            } catch (error) {
                showResult('updateMeResult', { error: error.message }, false);
            }
        }

        async function testDeleteMe() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('deleteMeResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            if (!confirm('ì •ë§ë¡œ ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ëª¨ë“  ë°ì´í„°ê°€ ì˜êµ¬ ì‚­ì œë©ë‹ˆë‹¤.')) {
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/users/me`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('deleteMeResult', data, true);
                    // í† í° ì‚­ì œ ë° í† í° ì„¹ì…˜ ìˆ¨ê¸°ê¸°
                    localStorage.removeItem('vto_access_token');
                    document.getElementById('tokenSection').style.display = 'none';
                    alert('ê³„ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    showResult('deleteMeResult', data, false);
                }
            } catch (error) {
                showResult('deleteMeResult', { error: error.message }, false);
            }
        }

        async function testCreateCollection() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('createCollectionResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            const name = document.getElementById('collectionName').value;

            try {
                const response = await fetch(`${API_URL()}/api/v1/collections`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('createCollectionResult', data, true);
                    // Collection IDë¥¼ update í¼ì— ìë™ ì…ë ¥
                    document.getElementById('updateCollectionId').value = data.id;
                } else {
                    showResult('createCollectionResult', data, false);
                }
            } catch (error) {
                showResult('createCollectionResult', { error: error.message }, false);
            }
        }

        async function testGetCollections() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('getCollectionsResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/collections`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('getCollectionsResult', data, true);
                } else {
                    showResult('getCollectionsResult', data, false);
                }
            } catch (error) {
                showResult('getCollectionsResult', { error: error.message }, false);
            }
        }

        async function testUpdateCollection() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('updateCollectionResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            const collectionId = document.getElementById('updateCollectionId').value;
            const name = document.getElementById('updateCollectionName').value;

            if (!collectionId) {
                showResult('updateCollectionResult', { error: 'Collection IDë¥¼ ì…ë ¥í•˜ì„¸ìš”' }, false);
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/collections/${collectionId}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ name })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('updateCollectionResult', data, true);
                } else {
                    showResult('updateCollectionResult', data, false);
                }
            } catch (error) {
                showResult('updateCollectionResult', { error: error.message }, false);
            }
        }

        async function testCreateProject() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('createProjectResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            const collectionId = document.getElementById('projectCollectionId').value;
            const name = document.getElementById('projectName').value;

            if (!collectionId) {
                showResult('createProjectResult', { error: 'Collection IDë¥¼ ì…ë ¥í•˜ì„¸ìš”' }, false);
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/projects`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        collection_id: collectionId,
                        name 
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('createProjectResult', data, true);
                    // Project ID ìë™ ì…ë ¥
                    document.getElementById('getProjectId').value = data.id;
                } else {
                    showResult('createProjectResult', data, false);
                }
            } catch (error) {
                showResult('createProjectResult', { error: error.message }, false);
            }
        }

        async function testGetProject() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('getProjectResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            const projectId = document.getElementById('getProjectId').value;

            if (!projectId) {
                showResult('getProjectResult', { error: 'Project IDë¥¼ ì…ë ¥í•˜ì„¸ìš”' }, false);
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/projects/${projectId}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('getProjectResult', data, true);
                } else {
                    showResult('getProjectResult', data, false);
                }
            } catch (error) {
                showResult('getProjectResult', { error: error.message }, false);
            }
        }

        async function testGetProjects() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('getProjectsResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/projects`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('getProjectsResult', data, true);
                } else {
                    showResult('getProjectsResult', data, false);
                }
            } catch (error) {
                showResult('getProjectsResult', { error: error.message }, false);
            }
        }

        async function testGetProjectsByCollection() {
            const token = localStorage.getItem('vto_access_token');
            if (!token) {
                showResult('getProjectsByCollectionResult', { error: 'ë¨¼ì € ë¡œê·¸ì¸í•˜ì„¸ìš”' }, false);
                return;
            }

            const collectionId = document.getElementById('filterCollectionId').value;

            if (!collectionId) {
                showResult('getProjectsByCollectionResult', { error: 'Collection IDë¥¼ ì…ë ¥í•˜ì„¸ìš”' }, false);
                return;
            }

            try {
                const response = await fetch(`${API_URL()}/api/v1/projects?collection_id=${collectionId}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResult('getProjectsByCollectionResult', data, true);
                } else {
                    showResult('getProjectsByCollectionResult', data, false);
                }
            } catch (error) {
                showResult('getProjectsByCollectionResult', { error: error.message }, false);
            }
        }

        // Load saved token on page load
        window.addEventListener('DOMContentLoaded', () => {
            const token = localStorage.getItem('vto_access_token');
            const userId = localStorage.getItem('vto_user_id');
            if (token) {
                saveToken(token, userId);
            }
        });
    </script>
</body>
</html>
